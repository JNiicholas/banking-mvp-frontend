<h2 class="mt-4 mb-3">My Accounts</h2>

@if (loading) {
  <div>Loading accountsâ€¦</div>
} @else if (error) {
  <div class="text-red-500">{{ error }}</div>
} @else {
  @if (accounts.length > 0) {
    <div class="accounts-grid">
      @for (acc of accounts; track acc.id) {
        <p-card
          [style]="{ 'background-color': '#0d1b2a', 'color': '#e0e0e0', 'border-radius': '8px', 'border': '1px solid #1e3a5f', 'padding': '1rem', 'cursor': 'pointer' }"
          styleClass="mb-3"
          (click)="openAccount(acc.id)"
          (keydown.enter)="openAccount(acc.id)"
          (keydown.space)="$event.preventDefault(); openAccount(acc.id)"
          tabindex="0"
          role="button"
        >
          <ng-template pTemplate="header">
            <div class="flex justify-between items-center">
              <div class="flex items-center">
                <i class="pi pi-wallet mr-2"></i>
                <span class="font-semibold text-lg">{{ acc.ibanDisplay || acc.ibanNormalized }}</span>
              </div>
              <div class="flex items-center">
                <span class="balance-label text-sm mr-2">Balance</span>
                <span class="balance-value font-bold text-xl">{{ acc.balance | number:'1.2-2' }}</span>
                <span class="ml-1">EUR</span>
              </div>
            </div>
          </ng-template>
          <ng-template pTemplate="footer">
            <div class="flex items-center">
              <button
                pButton
                type="button"
                class="p-button-text p-button-sm"
                icon="pi pi-info-circle"
                label="Debug info"
                (click)="$event.stopPropagation(); op.toggle($event)"
              ></button>

              <p-popover #op>
                <pre class="text-xs m-0">{{ acc | json }}</pre>
              </p-popover>
            </div>
          </ng-template>
        </p-card>
      } @empty {
        <!-- no items -->
      }
    </div>
  } @else {
    <p>No accounts found.</p>
  }
}
